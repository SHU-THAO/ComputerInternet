## **1. 从输入网址到获得页面的过程**

1. **若DNS缓存中没有相关数据，则浏览器先向DNS服务器发出DNS请求：**
   这一过程的目的是获取[www.meituan.com](http://www.meituan.com/)这个域名所对应的IP地址；
   IE浏览器向本机DNS模块发出DNS请求，DNS模块生成相关的DNS报文；
   DNS模块将生成的DNS报文传递给传输层的UDP协议单元
   UDP协议单元将该数据封装成UDP数据报，传递给网络层的IP协议单元；
   IP协议单元将该数据封装成IP数据包，其中目的IP地址为DNS服务器的IP地址；
   封装好的IP数据包将传递给数据链路层的协议单元进行发送；
   发送时如果ARP缓存中没有相关数据，则发送ARP广播请求，等待ARP回应；
   得到ARP回应后，将IP地址与路由下一跳MAC地址对应的信息写入ARP缓存表；
   写入缓存后，以路由下一跳地址填充目的MAC地址，并以数据帧形式转发；
   这个转发过程可能会进行多次，这取决于DNS服务器在校园网中的位置；
   DNS请求被发送到DNS服务器的数据链路层协议单元；
   DNS服务器的数据链路层协议单元解析收到的数据帧，将其内部所含有的IP数据包传递给网络层IP协议单元；
   DNS服务器的IP协议单元解析收到的IP数据包，将其内部所含有的UDP数据报传递给传输层的UDP协议单元；
   DNS服务器的UDP协议单元解析收到的UDP数据包，将其内部所含有的DNS报文传递给该服务器上的DNS服务单元；
   DNS服务单元收到DNS请求，将域名解析为对应的IP地址，产生DNS回应报文；
   DNS回应报文→UDP→IP→MAC→→请求域名解析的主机；
   请求域名解析的主机收到数据帧，该数据帧→IP→UDP→DNS→IE浏览器；
   将域名解析的结果以域名和IP地址对应的形式写入DNS缓存表。

2. **浏览器与www.meituan.com建立TCP连接**
   浏览器向www.meituan.com发出TCP连接请求报文；
   该请求TCP报文中的SYN标志位被设置为1，表示连接请求；
   该TCP请求报文→IP(DNS)→MAC(ARP)→→校园网关→→www.meituan.com主机；
   该TCP请求报文经过IP层时，填入的目的IP地址就是上面DNS过程获得的IP地址；
   经过数据链路层时，若MAC地址不明，还要进行上面所叙述的ARP过程；
   www.meituan.com收到的数据帧→IP→TCP，TCP协议单元会回应请求应答报文；
   该请求应答TCP报文中的SYN和ACK标志位均被设置为1，表示连接请求应答；
   该TCP请求应答报文→IP→MAC(ARP)→→校园网关→→请求主机；
   请求主机收到数据帧→IP→TCP，TCP协议单元会回应请求确认报文；
   该请求应答TCP报文中的ACK标志位被设置为1，表示连接请求确认；
   该TCP请求确认报文→IP→MAC(ARP)→→校园网关→→请求主机；
   请求主机收到的数据帧→IP→TCP，连接建立完成；
   在这个过程中，任何一个报文出错或超时，都要进行重传；
   这个过程被称为TCP建立连接的三次握手。

3. **IE浏览器开始HTTP访问过程**
   IE浏览器向[www.meituan.com]发出HTTP-GET方法报文；
   该HTTP-GET方法报文→TCP→IP→MAC→→校园网关→→请求主机；
   收到的数据帧→IP→TCP→HTTP，HTTP协议单元会回应HTTP协议格式封装好的HTML超文本形式数据；
   HTTP-HTML数据→TCP→IP→MAC(ARP)→→校园网关→→请求主机；
   请求主机收到的数据帧→IP→TCP→HTTP→IE浏览器，浏览器会以网页形式显示HTML超文本，就是我们所看到的网页。

4. **断开TCP连接**

   IE浏览器向www.meituan.com发出TCP连接结束请求报文；
   该请求TCP报文中的FIN标志位被设置为1，表示结束请求；
   该TCP结束请求报文→IP→MAC(ARP)→→校园网关→→请求主机；
   服务器收到的数据帧→IP→TCP，TCP协议单元会回应结束应答报文；
   该结束应答TCP报文中的FIN和ACK标志位均被设置为1，表示结束应答；
   该TCP结束应答报文→IP→MAC(ARP)→→校园网关→→请求主机；
   这个过程需要双向进行，因此www.meituan.com主机也会按上述流程再做一次；
   整个过程被称为TCP断开连接的四次握手。

注：

1. IP地址与MAC地址的区别：

   ​	ip就像是你的房间号，mac地址就像是你的身份证号码。ip地址是可以改变的，而mac地址是厂商制定的不可改变的。域名地址、IP地址和MAC地址，分别对应应用层、网络层、物理层。网络管理一般就是在网络层针对IP地址进行管理，但由于一台计算机(电脑)的IP地址可以由用户自行设定，管理起来相对困难，MAC地址一般不可更改，所以把IP地址同MAC地址组合到一起管理就成为常见的管理方式。 IP地址基于逻辑，比较灵活，不受硬件限制，也容易记忆。MAC地址在一定程度上与硬件一致，基于物理，能够标识具体。这两种地址各有好处，使用时也因条件而采取不同的地址。使用MAC地址的关键是由组网方式决定的，如今比较流行的接入Internet的方式（也是未来发展的方向）是把主机通过局域网组织在一起，然后再通过交换机和 Internet相连接。这样一来就出现了如何区分具体用户，防止盗用的问题。由于IP只是逻辑上标识，任何人都随意修改，因此不能用来标识用户；而 MAC地址则不然，它是固化在网卡里面的。从理论上讲，除非盗来硬件（网卡），否则是没有办法冒名顶替的，基于MAC地址的这种特点，局域网采用了用MAC地址来标识具体用户的方法。具体实现是在交换机内部通过“表”的方式把MAC地址和IP地址一一对应，也就是所说的IP、MAC绑定。

2. 服务器是直接发送JSP页面到浏览器吗？
   html是静态的，jsp是动态的，动态的数据处理之后，呈现出来的就是纯html的了。
   当用户访问一个JSP页面时，容器对JSP页面的处理通常可分为两个时期：**转译时期（Translation Time）**和 **请求时期（Request Time）**。在转译时期，JSP网页被转译成Servlet类，然后被编译成class文件；在请求时期，容器加载编译后的 Servlet类，并把响应结果返回至客户端，整个流程可分为三个步骤，流程图如下：

   ![JSPè¿è¡æµç¨.jpg-16.1kB](D:\java\md_pictures\JavaWeb\Jsp的执行过程.jpg)

   - 当客户第一次请求JSP页面时，JSP引擎会通过预处理把JSP文件中的静态数据（HTML文本）和动态数据（Java脚本）全部转换为Java代码。转换原则非常直观：对于HTML文本只是简单的用 out.println() 方法包裹起来，而对于Java脚本只是保留或做简单的处理； 
   - JSP引擎把生成的.java文件编译成Servlet类文件（.class）。对于Tomcat服务器而言，生成的类文件默认的情况下存放在\work目录； 
   - 编译后的class对象被加载到容器中，并根据用户的请求生成HTML格式的响应页面。



## **2. 常见的HTTP的状态码**

​	HTTP请求结构： 请求方式 + 请求URI + 协议及其版本 
​	HTTP响应结构： 状态码 + 原因短语 + 协议及其版本

- 1×× : 请求处理中，请求已被接受，正在处理

- 2×× : 请求成功，请求被成功处理 

  200 OK

- 3×× : 重定向，要完成请求必须进行进一步处理 
  301 ：永久性转移 
  302 ：暂时性转移 
  304 ： 已缓存

- 4×× : 客户端错误，请求不合法 
  400：Bad Request,请求有语法问题 
  403：拒绝请求 
  404：客户端所访问的页面不存在

- 5×× : 服务器端错误，服务器不能处理合法请求 
  500 ：服务器内部错误 
  503 ： 服务不可用，稍等 

